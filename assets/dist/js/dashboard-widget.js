!function(){"use strict";const{nonce:t,root:e}=window.koko_analytics;function n(n,o={}){let r=e+"koko-analytics/v1"+n+"?"+new URLSearchParams(o);return fetch(r,{headers:{"X-WP-Nonce":t,Accepts:"application/json"},credentials:"same-origin"}).then((t=>{if(t.status>=400)throw console.error("Koko Analytics encountered an error trying to request data from the REST endpoints. Please check your PHP error logs for the error that occurred."),new Error(t.statusText);return t})).then((t=>t.json()))}window.setTimeout((()=>{window.location.reload()}),432e5);const o=1e6,r=1e3,i=/\.0+$/;function l(t){let e=0;return t>=o?(t/=o,e=Math.max(0,3-String(Math.round(t)).length),t.toFixed(e).replace(i,"")+"M"):t>=10*r?(t/=r,e=Math.max(0,3-String(Math.round(t)).length),t.toFixed(e).replace(i,"")+"K"):String(t)}function a(t){if(null===t)return null;const e=t.split("-");if(2===e.length&&e.push("1"),3!==e.length)return null;let[n,o,r]=e.map((t=>parseInt(t,10)));return n<1e3&&(n+=2e3),n<2e3||n>3e3||o<1||o>12||r<1||r>31?null:new Date(n,o-1,r)}function s(t){return t<10?"0"+t:t}function c(t){return`${t.getFullYear()}-${s(t.getMonth()+1)}-${s(t.getDate())}`}function d(t,e){t="string"==typeof t?a(t):t,e=e||{day:"numeric",month:"short",year:"numeric"};try{return new Intl.DateTimeFormat(void 0,e).format(t)}catch(t){}return t.toLocaleDateString()}function u(t,e,n,o,r){return{sel:t,data:e,children:n,text:o,elm:r,key:void 0===e?void 0:e.key}}const f=Array.isArray;function h(t){return"string"==typeof t||"number"==typeof t||t instanceof String||t instanceof Number}function v(t){if(m(t)){for(;t&&m(t);)t=p(t).parent;return null!=t?t:null}return t.parentNode}function m(t){return 11===t.nodeType}function p(t,e){var n,o,r;const i=t;return null!==(n=i.parent)&&void 0!==n||(i.parent=null!=e?e:null),null!==(o=i.firstChildNode)&&void 0!==o||(i.firstChildNode=t.firstChild),null!==(r=i.lastChildNode)&&void 0!==r||(i.lastChildNode=t.lastChild),i}const g={createElement:function(t,e){return document.createElement(t,e)},createElementNS:function(t,e,n){return document.createElementNS(t,e,n)},createTextNode:function(t){return document.createTextNode(t)},createDocumentFragment:function(){return p(document.createDocumentFragment())},createComment:function(t){return document.createComment(t)},insertBefore:function(t,e,n){if(m(t)){let e=t;for(;e&&m(e);)e=p(e).parent;t=null!=e?e:t}m(e)&&(e=p(e,t)),n&&m(n)&&(n=p(n).firstChildNode),t.insertBefore(e,n)},removeChild:function(t,e){t.removeChild(e)},appendChild:function(t,e){m(e)&&(e=p(e,t)),t.appendChild(e)},parentNode:v,nextSibling:function(t){var e;if(m(t)){const n=p(t),o=v(n);if(o&&n.lastChildNode){const t=Array.from(o.childNodes),r=t.indexOf(n.lastChildNode);return null!==(e=t[r+1])&&void 0!==e?e:null}return null}return t.nextSibling},tagName:function(t){return t.tagName},setTextContent:function(t,e){t.textContent=e},getTextContent:function(t){return t.textContent},isElement:function(t){return 1===t.nodeType},isText:function(t){return 3===t.nodeType},isComment:function(t){return 8===t.nodeType},isDocumentFragment:m};function y(t){return void 0===t}function x(t){return void 0!==t}const w=u("",{},[],void 0,void 0);function k(t,e){var n,o;const r=t.key===e.key,i=(null===(n=t.data)||void 0===n?void 0:n.is)===(null===(o=e.data)||void 0===o?void 0:o.is),l=t.sel===e.sel,a=!(!t.sel&&t.sel===e.sel)||typeof t.text==typeof e.text;return l&&r&&i&&a}function C(){throw new Error("The document fragment is not supported on this platform.")}function N(t,e,n){var o;const r={};for(let i=e;i<=n;++i){const e=null===(o=t[i])||void 0===o?void 0:o.key;void 0!==e&&(r[e]=i)}return r}const b=["create","update","remove","destroy","pre","post"];function E(t,e,n){if("function"==typeof t)t.call(e,n,e);else if("object"==typeof t)for(let o=0;o<t.length;o++)E(t[o],e,n)}function S(t,e){const n=t.type,o=e.data.on;o&&o[n]&&E(o[n],e,t)}function T(t,e){const n=t.data.on,o=t.listener,r=t.elm,i=e&&e.data.on,l=e&&e.elm;let a;if(n!==i){if(n&&o)if(i)for(a in n)i[a]||r.removeEventListener(a,o,!1);else for(a in n)r.removeEventListener(a,o,!1);if(i){const o=e.listener=t.listener||function t(e){S(e,t.vnode)};if(o.vnode=e,n)for(a in i)n[a]||l.addEventListener(a,o,!1);else for(a in i)l.addEventListener(a,o,!1)}}}const A={create:T,update:T,destroy:T};function M(t,e){let n;const o=e.elm;let r=t.data.attrs,i=e.data.attrs;if((r||i)&&r!==i){for(n in r=r||{},i=i||{},i){const t=i[n];r[n]!==t&&(!0===t?o.setAttribute(n,""):!1===t?o.removeAttribute(n):120!==n.charCodeAt(0)?o.setAttribute(n,t):58===n.charCodeAt(3)?o.setAttributeNS("http://www.w3.org/XML/1998/namespace",n,t):58===n.charCodeAt(5)?o.setAttributeNS("http://www.w3.org/1999/xlink",n,t):o.setAttribute(n,t))}for(n in r)n in i||o.removeAttribute(n)}}const $={create:M,update:M};function B(t,e,n){if(t.ns="http://www.w3.org/2000/svg","foreignObject"!==n&&void 0!==e)for(let t=0;t<e.length;++t){const n=e[t];if("string"==typeof n)continue;const o=n.data;void 0!==o&&B(o,n.children,n.sel)}}function D(t,e,n){let o,r,i,l={};if(void 0!==n?(null!==e&&(l=e),f(n)?o=n:h(n)?r=n.toString():n&&n.sel&&(o=[n])):null!=e&&(f(e)?o=e:h(e)?r=e.toString():e&&e.sel?o=[e]:l=e),void 0!==o)for(i=0;i<o.length;++i)h(o[i])&&(o[i]=u(void 0,void 0,void 0,o[i],void 0));return"s"!==t[0]||"v"!==t[1]||"g"!==t[2]||3!==t.length&&"."!==t[3]&&"#"!==t[3]||B(l,o,t),u(t,l,o,r,void 0)}const{i18n:F}=window.koko_analytics,L=function(t,e,n){const o={create:[],update:[],remove:[],destroy:[],pre:[],post:[]},r=g;for(const e of b)for(const n of t){const t=n[e];void 0!==t&&o[e].push(t)}function i(t,e){return function(){if(0==--e){const e=r.parentNode(t);r.removeChild(e,t)}}}function l(t,e){var i,a,s,c;let d,u=t.data;if(void 0!==u){const e=null===(i=u.hook)||void 0===i?void 0:i.init;x(e)&&(e(t),u=t.data)}const v=t.children,m=t.sel;if("!"===m)y(t.text)&&(t.text=""),t.elm=r.createComment(t.text);else if(void 0!==m){const n=m.indexOf("#"),i=m.indexOf(".",n),s=n>0?n:m.length,c=i>0?i:m.length,p=-1!==n||-1!==i?m.slice(0,Math.min(s,c)):m,g=t.elm=x(u)&&x(d=u.ns)?r.createElementNS(d,p,u):r.createElement(p,u);for(s<c&&g.setAttribute("id",m.slice(s+1,c)),i>0&&g.setAttribute("class",m.slice(c+1).replace(/\./g," ")),d=0;d<o.create.length;++d)o.create[d](w,t);if(f(v))for(d=0;d<v.length;++d){const t=v[d];null!=t&&r.appendChild(g,l(t,e))}else h(t.text)&&r.appendChild(g,r.createTextNode(t.text));const y=t.data.hook;x(y)&&(null===(a=y.create)||void 0===a||a.call(y,w,t),y.insert&&e.push(t))}else if((null===(s=null==n?void 0:n.experimental)||void 0===s?void 0:s.fragments)&&t.children){for(t.elm=(null!==(c=r.createDocumentFragment)&&void 0!==c?c:C)(),d=0;d<o.create.length;++d)o.create[d](w,t);for(d=0;d<t.children.length;++d){const n=t.children[d];null!=n&&r.appendChild(t.elm,l(n,e))}}else t.elm=r.createTextNode(t.text);return t.elm}function a(t,e,n,o,i,a){for(;o<=i;++o){const i=n[o];null!=i&&r.insertBefore(t,l(i,a),e)}}function s(t){var e,n;const r=t.data;if(void 0!==r){null===(n=null===(e=null==r?void 0:r.hook)||void 0===e?void 0:e.destroy)||void 0===n||n.call(e,t);for(let e=0;e<o.destroy.length;++e)o.destroy[e](t);if(void 0!==t.children)for(let e=0;e<t.children.length;++e){const n=t.children[e];null!=n&&"string"!=typeof n&&s(n)}}}function c(t,e,n,l){for(var a,d;n<=l;++n){let l,u;const f=e[n];if(null!=f)if(x(f.sel)){s(f),l=o.remove.length+1,u=i(f.elm,l);for(let t=0;t<o.remove.length;++t)o.remove[t](f,u);const t=null===(d=null===(a=null==f?void 0:f.data)||void 0===a?void 0:a.hook)||void 0===d?void 0:d.remove;x(t)?t(f,u):u()}else f.children?(s(f),c(t,f.children,0,f.children.length-1)):r.removeChild(t,f.elm)}}function d(t,e,n){var i,s,u,f,h,v,m,p;const g=null===(i=e.data)||void 0===i?void 0:i.hook;null===(s=null==g?void 0:g.prepatch)||void 0===s||s.call(g,t,e);const w=e.elm=t.elm;if(t===e)return;if(void 0!==e.data||x(e.text)&&e.text!==t.text){null!==(u=e.data)&&void 0!==u||(e.data={}),null!==(f=t.data)&&void 0!==f||(t.data={});for(let n=0;n<o.update.length;++n)o.update[n](t,e);null===(m=null===(v=null===(h=e.data)||void 0===h?void 0:h.hook)||void 0===v?void 0:v.update)||void 0===m||m.call(v,t,e)}const C=t.children,b=e.children;y(e.text)?x(C)&&x(b)?C!==b&&function(t,e,n,o){let i,s,u,f,h=0,v=0,m=e.length-1,p=e[0],g=e[m],x=n.length-1,w=n[0],C=n[x];for(;h<=m&&v<=x;)null==p?p=e[++h]:null==g?g=e[--m]:null==w?w=n[++v]:null==C?C=n[--x]:k(p,w)?(d(p,w,o),p=e[++h],w=n[++v]):k(g,C)?(d(g,C,o),g=e[--m],C=n[--x]):k(p,C)?(d(p,C,o),r.insertBefore(t,p.elm,r.nextSibling(g.elm)),p=e[++h],C=n[--x]):k(g,w)?(d(g,w,o),r.insertBefore(t,g.elm,p.elm),g=e[--m],w=n[++v]):(void 0===i&&(i=N(e,h,m)),s=i[w.key],y(s)?r.insertBefore(t,l(w,o),p.elm):(u=e[s],u.sel!==w.sel?r.insertBefore(t,l(w,o),p.elm):(d(u,w,o),e[s]=void 0,r.insertBefore(t,u.elm,p.elm))),w=n[++v]);v<=x&&(f=null==n[x+1]?null:n[x+1].elm,a(t,f,n,v,x,o)),h<=m&&c(t,e,h,m)}(w,C,b,n):x(b)?(x(t.text)&&r.setTextContent(w,""),a(w,null,b,0,b.length-1,n)):x(C)?c(w,C,0,C.length-1):x(t.text)&&r.setTextContent(w,""):t.text!==e.text&&(x(C)&&c(w,C,0,C.length-1),r.setTextContent(w,e.text)),null===(p=null==g?void 0:g.postpatch)||void 0===p||p.call(g,t,e)}return function(t,e){let n,i,a;const s=[];for(n=0;n<o.pre.length;++n)o.pre[n]();for(function(t,e){return t.isElement(e)}(r,t)?t=function(t){const e=t.id?"#"+t.id:"",n=t.getAttribute("class"),o=n?"."+n.split(" ").join("."):"";return u(r.tagName(t).toLowerCase()+e+o,{},[],void 0,t)}(t):function(t,e){return t.isDocumentFragment(e)}(r,t)&&(t=u(void 0,{},[],void 0,t)),k(t,e)?d(t,e,s):(i=t.elm,a=r.parentNode(i),l(e,s),null!==a&&(r.insertBefore(a,e.elm,r.nextSibling(i)),c(a,[t],0,0))),n=0;n<s.length;++n)s[n].data.hook.insert(s[n]);for(n=0;n<o.post.length;++n)o.post[n]();return e}}([A,$]),j={left:48,bottom:36,top:24,right:24},P=function(){const t=document.createElement("div");return t.className="ka-chart--tooltip",t.style.display="none",t.innerHTML=`\n<div class="ka-chart--tooltip-box">\n  <div class="ka-chart--tooltip-heading"></div>\n  <div style="display: flex">\n    <div class="ka-chart--tooltip-content ka--visitors">\n      <div class="ka-chart--tooltip-amount"></div>\n      <div>${F.Visitors}</div>\n    </div>\n    <div class="ka-chart--tooltip-content ka--pageviews">\n      <div class="ka-chart--tooltip-amount"></div>\n      <div>${F.Pageviews}</div>\n    </div>\n  </div>\n</div>\n<div class="ka-chart--tooltip-arrow"></div>`,t}();function q(){P.style.display="none"}function H(t,e,o,r,i){i||(i=Math.max(240,Math.min(window.innerHeight/3,360))),t.parentElement.style.minHeight=`${i+4}px`;let a=r-o>=314496e5?{month:"short",year:"numeric"}:void 0;const s=t.clientWidth-j.left-j.right,u=i-j.bottom-j.top;function f(e,o){const r=o-e>=314496e5;a=r?{month:"short",year:"numeric"}:void 0,n("/stats",{start_date:c(e),end_date:c(o),monthly:r?1:0}).then((e=>{t=L(t,h(e))}))}function h(t){if(t.length<=1)return D("!");const e=s/t.length,n=.9*e,o=(e-n)/2,r=function(t){const e=function(t){if(t<10)return 10;const e=Math.floor(Math.log10(t)),n=Math.pow(10,e);return Math.ceil(t/n)*n}(t);return{ticks:[0,e/2,e],max:e}}(t.reduce(((t,e)=>t.pageviews>e.pageviews?t:e),0).pageviews),c=t.length<=90,f=u/r.max,h=t=>t*e,v=r.max<=0?()=>u:t=>u-t*f;return D("svg",{attrs:{width:"100%",height:i}},[D("g",[D("g",{attrs:{class:"axes-y",transform:`translate(0, ${j.top})`,"text-anchor":"end"}},r.ticks.map((t=>{const e=v(t);return D("g",[D("line",{attrs:{stroke:"#eee",x1:j.left,x2:s+j.left,y1:e,y2:e}}),D("text",{attrs:{y:e,fill:"#757575",x:.75*j.left,dy:"0.33em"}},l(t))])}))),D("g",{attrs:{class:"axes-x","text-anchor":"middle",transform:`translate(${j.left}, ${j.top+u})`}},t.map(((n,o)=>{let r=0===o||o===t.length-1?n.date:null;if(!c&&!r)return null;const i=h(o)+.5*e;return D("g",[D("line",{attrs:{stroke:"#ddd",x1:i,x2:i,y1:0,y2:6}}),r?D("text",{attrs:{fill:"#757575",x:i,y:10,dy:"1em"}},d(n.date,a)):""])})).filter((t=>null!==t)))]),D("g",{attrs:{class:"bars",transform:`translate(${j.left}, ${j.top})`}},t.map(((t,e)=>{const r=t.pageviews*f,i=t.visitors*f,l=h(e),s=function(t,e){return n=>{P.querySelector(".ka-chart--tooltip-heading").textContent=d(t.date,a),P.querySelector(".ka--visitors").children[0].textContent=t.visitors,P.querySelector(".ka--pageviews").children[0].textContent=t.pageviews;const o=n.currentTarget.getBoundingClientRect();P.style.display="block",P.style.left=o.left+window.scrollX-.5*P.clientWidth+.5*e+"px",P.style.top=o.y+window.scrollY-P.clientHeight+"px"}}(t,n);return D("g",{on:{click:s,mouseenter:s,mouseleave:q}},[D("rect",{attrs:{class:"ka--pageviews",height:r,width:n,x:l+o,y:v(t.pageviews)}}),D("rect",{attrs:{class:"ka--visitors",height:i,width:n,x:l+o,y:v(t.visitors)}})])})))])}return e.length?t=L(t,h(e)):f(o,r),document.body.appendChild(P),document.addEventListener("click",(e=>{for(let n=e.target;null!==n;n=n.parentElement)if(n===t.elm)return;q()})),{update:f}}const _=document.getElementById("koko-analytics-dashboard-widget-mount"),{data:O,startDate:W,endDate:I}=window.koko_analytics;function R(){_.clientWidth&&H(_,O.chart,a(W),a(I),200)}window.jQuery(document).on("postbox-toggled",R),_.parentElement.style.display="",window.requestAnimationFrame(R)}();